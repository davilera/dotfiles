#!/usr/bin/env bash

while [ $# -ge 1 ]; do

  INPUT=$1
  BACKUP=$INPUT.bkp
  OUTFILE="${INPUT%.*}.jpg"

  echo -n "Converting $INPUTâ€¦" >&2
  mv "$INPUT" "$BACKUP"
  magick "$BACKUP" -resize "1200x800^" -gravity center -crop 1200x800+0+0 -define jpeg:extent=250kb "$OUTFILE"
  exiftool -all= "$OUTFILE"
  rm "${OUTFILE}_original"
  echo " Done!" >&2

  shift

done
